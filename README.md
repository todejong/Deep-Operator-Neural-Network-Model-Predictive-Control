# Deep Operator Neural Network Model Predictive Control

This repository contains supplementary code for the paper:  
**Deep Operator Neural Network Model Predictive Control**.

We demonstrate the use of Deep Operator Networks (DeepONets) and Multi-Step Deep Operator Networks (MS-DeepONets) in the context of Model Predictive Control (MPC) across three nonlinear dynamical systems.

---

## 📁 Repository Structure

Each example system is contained in its own folder:

- `Van_der_Pol` (to appear soon)
- `Four_tank` (to appear soon)
- `Pendulum_on_cart` (to appear soon)

Each folder includes:

- `DeepONet_simulation.ipynb` — Simulation and training using standard DeepONet  
- `MS_DeepONet_simulation.ipynb` — Simulation and training using MS-DeepONet
- `models.py` — Contains several pre defined neural network models
- `functions.py` — Contains several functions used in the code
- `data_standard/` — Stores data used/generated by the DeepONet_simulation notebook  
- `data_MS/` — Stores data used/generated by the MS_DeepONet_simulation notebook

---

## 📦 Requirements

Python 3.11.7 is used for generating the examples 

## 📓 Development Environment
- `jupyter` (for running and developing in Jupyter Notebooks)

## 🧰 Dependencies

This project requires the following Python libraries:

### 📦 Libraries
- `time`
- `itertools`
- `numpy`
- `pandas`
- `scipy`
- `matplotlib`
- `torch` (PyTorch)
- `torch.nn.functional`
- `casadi` (used for solving MPC problems)

---

## 🚀 How to Run

1. Clone the repository:

```bash
git clone https://github.com/yourusername/DeepONet_MPC.git
cd DeepONet_MPC
```

2. Navigate to one of the example folders:

```bash
cd Van_der_Pol
```

3. Launch Jupyter Notebook:

```bash
jupyter notebook
```

4. Open and run all code blocks from top to bottom for either:
   - `DeepONet_simulation.ipynb` for standard DeepONet architecture  
   - `MS_DeepONet_simulation.ipynb` for the MS-DeepONet architecture  

---

## 📊 Examples

Each notebook will:

- Generate training and validation data 
- Train the respective DeepONet architecture  
- Run closed-loop MPC simulations 
- Save results to the corresponding `data_standard/` or `data_MS/` folder  
- Visualize simulation and training results  

---

## 📄 Citation

If you use this code in your work, please cite the following paper:

```bibtex
@misc{dejong2025deepoperatorneuralnetwork,
      title={Deep Operator Neural Network Model Predictive Control}, 
      author={Thomas Oliver de Jong and Khemraj Shukla and Mircea Lazar},
      year={2025},
      eprint={2505.18008},
      archivePrefix={arXiv},
      primaryClass={math.OC},
      url={https://arxiv.org/abs/2505.18008}, 
}
```

---

## 📬 Contact

We welcome questions, feedback, and collaboration opportunities!

- 📧 **Primary contact**: [t.o.d.jong@tue.nl](mailto:t.o.d.jong@tue.nl)
- 📧 **Co-authors**:
  - [khemraj_shukla@brown.edu](mailto:khemraj_shukla@brown.edu)
  - [m.lazar@tue.nl](mailto:m.lazar@tue.nl)

Feel free to reach out via email for more information about this project or related research.





