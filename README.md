# Deep Operator Neural Network Model Predictive Control

This repository contains supplementary code for the paper:  
**Deep Operator Neural Network Model Predictive Control**.

We demonstrate the use of Deep Operator Networks (DeepONets) and Multi-Step Deep Operator Networks (MS-DeepONets) in the context of Model Predictive Control (MPC) across three nonlinear dynamical systems.

---

## ğŸ“ Repository Structure

Each example system is contained in its own folder:

- `Van_der_Pol`
- `Four_tank`
- `Pendulum_on_cart`

Each folder includes:

- `DeepONet_simulation.ipynb` â€” Simulation and training using standard DeepONet  
- `MS_DeepONet_simulation.ipynb` â€” Simulation and training using MS-DeepONet
- `models.py` â€” Contains several pre defined neural network models
- `functions.py` â€” Contains several functions used in the code
- `data_standard/` â€” Stores data used/generated by the DeepONet_simulation notebook  
- `data_MS/` â€” Stores data used/generated by the MS_DeepONet_simulation notebook

---

## ğŸ“¦ Requirements

Python 3.11.7 is used for generating the examples 

## ğŸ““ Development Environment
- `jupyter` (for running and developing in Jupyter Notebooks)

## ğŸ§° Dependencies

This project requires the following Python libraries:

### ğŸ“¦ Libraries
- `time`
- `itertools`
- `numpy`
- `pandas`
- `scipy`
- `matplotlib`
- `torch` (PyTorch)
- `torch.nn.functional`
- `casadi` (used for solving MPC problems)

---

## ğŸš€ How to Run

1. Clone the repository:

```bash
git clone https://github.com/yourusername/DeepONet_MPC.git
cd DeepONet_MPC
```

2. Navigate to one of the example folders:

```bash
cd Van_der_Pol
```

3. Launch Jupyter Notebook:

```bash
jupyter notebook
```

4. Open and run all code blocks from top to bottom for either:
   - `DeepONet_simulation.ipynb` for standard DeepONet architecture  
   - `MS_DeepONet_simulation.ipynb` for the MS-DeepONet architecture  

---

## ğŸ“Š Examples

Each notebook will:

- Generate training and validation data 
- Train the respective DeepONet architecture  
- Run closed-loop MPC simulations 
- Save results to the corresponding `data_standard/` or `data_MS/` folder  
- Visualize simulation and training results  

---

## ğŸ“„ Citation

If you use this code in your work, please cite the following paper:

```bibtex
@article{deepONetMPC2025,
  title={Deep Operator Neural Network Model Predictive Control},
  author={Doe, John and Smith, Jane and Zhao, Lin and Wang, Kai},
  journal={arXiv preprint arXiv:2505.12345},
  year={2025}
}
```

---

## ğŸ“¬ Contact

For questions, suggestions, or collaborations, please contact:  
ğŸ“§ **t.o.d.jong@tue.nl**


